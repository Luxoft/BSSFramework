<h1 class="tw-text-2xl">Permission edit</h1>

<div class="tw-grid tw-grid-cols-2 tw-gap-2">
  <mat-form-field>
    <mat-label>Role</mat-label>
    <input matInput type="text" [value]="data.permission.Role" [disabled]="true" />
  </mat-form-field>
  <mat-form-field>
    <mat-label>Comment</mat-label>
    <input matInput type="text" [(ngModel)]="data.permission.Comment" />
  </mat-form-field>
</div>
<h3 class="tw-text-xl">Contexts</h3>
<div class="tw-flex-1 tw-overflow-auto">
  <div class="tw-flex tw-gap-4 tw-h-full">
    <div *ngFor="let item of permissionEditDialogService.forms" class="tw-flex tw-flex-col">
      {{ item.controls.unit.value.Name }}
      <div class="tw-flex tw-gap-1 tw-items-center tw-mb-2">
        <mat-form-field [subscriptSizing]="'dynamic'" class="tw-h-12">
          <mat-label>Search</mat-label>
          <input matInput #input type="text" />
        </mat-form-field>
        <button
          class="tw-w-10 tw-h-10 tw-rounded hover:tw-bg-gray-100"
          aria-label="Massive paste"
          [title]="'Massive paste'"
          (click)="permissionEditDialogService.massInsert(item.controls.unit.value, item.controls.entities)">
          <mat-icon class="tw-mt-1">post_add</mat-icon>
        </button>
      </div>
      <div class="tw-overflow-y-auto tw-pb-2">
        <div
          *ngFor="let context of item.controls.entities.controls | filterContexts : input.value"
          class="tw-flex tw-items-center tw-gap-1 tw-relative">
          <app-select-entity class="tw-w-full" [control]="context" [unitId]="item.controls.unit.value.Id"></app-select-entity>
          <mat-icon
            title="Remove"
            (click)="permissionEditDialogService.remove(item.controls.entities, context)"
            class="tw-opacity-5 tw-absolute tw-right-0 hover:tw-opacity-100 tw-cursor-pointer"
            >delete
          </mat-icon>
        </div>
        <button mat-button (click)="permissionEditDialogService.add(item.controls.entities, null)">
          <mat-icon>add</mat-icon>
          <span>Add context</span>
        </button>
      </div>
    </div>
  </div>
</div>

<div class="tw-flex tw-justify-end tw-gap-2">
  <button mat-button (click)="cancel()">Cancel</button>
  <button mat-raised-button (click)="save()" color="primary">Submit</button>
</div>
